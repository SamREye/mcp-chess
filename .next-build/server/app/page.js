(()=>{var e={};e.id=931,e.ids=[931],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},86624:e=>{"use strict";e.exports=require("querystring")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},83413:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c}),t(33914),t(63494),t(10311);var r=t(69296),i=t(31650),a=t(87045),n=t.n(a),l=t(58184),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(s,o);let c=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,33914)),"/Users/samuelbourque/codex/mcp-chess/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,63494)),"/Users/samuelbourque/codex/mcp-chess/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,10311,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/samuelbourque/codex/mcp-chess/app/page.tsx"],u="/page",m={require:t,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},70301:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,34942,23))},78337:(e,s,t)=>{Promise.resolve().then(t.bind(t,10318))},62783:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,66544,23)),Promise.resolve().then(t.t.bind(t,93477,23)),Promise.resolve().then(t.t.bind(t,95116,23)),Promise.resolve().then(t.t.bind(t,96676,23)),Promise.resolve().then(t.t.bind(t,59645,23)),Promise.resolve().then(t.t.bind(t,88850,23))},10318:(e,s,t)=>{"use strict";t.d(s,{GameListPanel:()=>d});var r=t(98924),i=t(34942),a=t.n(i),n=t(83728),l=t(63911),o=t(39846);let c=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;function d({currentUserId:e}){let s=(0,n.useRouter)(),[t,i]=(0,l.useState)(e?"my":"others"),[d,u]=(0,l.useState)([]),[m,p]=(0,l.useState)(!1),[h,x]=(0,l.useState)(null),[g,v]=(0,l.useState)(""),[j,b]=(0,l.useState)([]),[y,f]=(0,l.useState)(null),[P,N]=(0,l.useState)("white"),[w,C]=(0,l.useState)(null),S=g.trim().toLowerCase(),q=(0,l.useMemo)(()=>j.find(e=>e.email?.toLowerCase()===S),[j,S])??y,_=q?.email?.toLowerCase()??(c.test(S)?S:null),G=!!(_&&!q);async function k(){if(_){x(null),C(null);try{let e=await (0,o._)("new_game",{opponentEmail:_,playAs:P});e.invitation.sent?C("Invitation email sent."):e.invitation.skippedReason?C(`Invitation not sent: ${e.invitation.skippedReason}`):e.invitation.error&&C(`Invitation failed: ${e.invitation.error}`),s.push(`/games/${e.game.id}`),s.refresh()}catch(e){x(e instanceof Error?e.message:"Failed to create game")}}}return(0,r.jsxs)("section",{className:"grid-2",children:[(0,r.jsxs)("div",{className:"panel stack",children:[(0,r.jsxs)("div",{className:"row",style:{justifyContent:"space-between"},children:[r.jsx("h2",{style:{margin:0},children:"Game List"}),(0,r.jsxs)("div",{className:"tabs",children:[r.jsx("button",{className:`tab ${"my"===t?"active":""}`,onClick:()=>i("my"),type:"button",children:"My Games"}),r.jsx("button",{className:`tab ${"others"===t?"active":""}`,onClick:()=>i("others"),type:"button",children:"Others' Games"})]})]}),e||"my"!==t?m?r.jsx("p",{className:"muted",children:"Loading games..."}):0===d.length?r.jsx("p",{className:"muted",children:"No games in this tab yet."}):r.jsx("ul",{className:"game-list",children:d.map(e=>(0,r.jsxs)("li",{children:[(0,r.jsxs)("div",{className:"row",style:{justifyContent:"space-between"},children:[(0,r.jsxs)("strong",{children:[e.white.email??e.white.id," vs ",e.black.email??e.black.id]}),r.jsx("span",{children:e.status})]}),(0,r.jsxs)("p",{className:"muted",children:[e.moveCount," moves â€¢ updated ",new Date(e.updatedAt).toLocaleString()]}),r.jsx(a(),{href:`/games/${e.id}`,children:"Open game"})]},e.id))}):r.jsx("p",{className:"muted",children:"Sign in to view your games."}),h&&r.jsx("p",{className:"error",children:h})]}),(0,r.jsxs)("div",{className:"panel stack",children:[r.jsx("h2",{style:{margin:0},children:"New Game"}),e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("label",{children:["Opponent email (or name)",r.jsx("input",{value:g,onChange:e=>{f(null),v(e.target.value)},placeholder:"Search by name/email or enter email"})]}),j.length>0&&r.jsx("ul",{className:"game-list",children:j.map(e=>r.jsx("li",{children:(0,r.jsxs)("button",{type:"button",onClick:()=>{e.email&&(f(e),v(e.email))},style:{all:"unset",cursor:"pointer"},children:[r.jsx("strong",{children:e.email??e.id}),r.jsx("p",{className:"muted",children:e.name??"No name set"})]})},e.id))}),G&&r.jsx("p",{className:"muted",children:"This email is not registered yet. You can still create the game and send an invitation."}),(0,r.jsxs)("label",{children:["You play as",(0,r.jsxs)("select",{value:P,onChange:e=>N(e.target.value),children:[r.jsx("option",{value:"white",children:"White"}),r.jsx("option",{value:"black",children:"Black"})]})]}),r.jsx("button",{type:"button",className:"primary",disabled:!_,onClick:()=>void k(),children:"Create game"}),w&&r.jsx("p",{className:"muted",children:w})]}):r.jsx("p",{className:"muted",children:"Sign in to create games and move pieces."})]})]})}},39846:(e,s,t)=>{"use strict";async function r(e,s={}){let t=await fetch("/api/mcp",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:crypto.randomUUID(),method:"tools/call",params:{name:e,arguments:s}}),credentials:"same-origin"}),r=await t.json();if(r.error)throw Error(r.error.message??"MCP call failed");let i=r?.result?.structuredContent;if(void 0!==i)return i;let a=r?.result?.content?.[0]?.text;if("string"==typeof a)return JSON.parse(a);throw Error("Invalid MCP response")}t.d(s,{_:()=>r})},63494:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>l,metadata:()=>n});var r=t(55886),i=t(68657);t(29944);var a=t(42073);let n={title:"MCP Chess",description:"Public chess games with MCP actions"};async function l({children:e}){let s=await (0,a.I)();return r.jsx("html",{lang:"en",children:r.jsx("body",{children:(0,r.jsxs)("div",{className:"page-shell",children:[(0,r.jsxs)("header",{className:"topbar",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{children:"MCP Chess"}),r.jsx("p",{children:"Moves and game actions are executed via MCP tools."})]}),(0,r.jsxs)("nav",{className:"topnav",children:[r.jsx(i.default,{href:"/",children:"Games"}),s?.user?(0,r.jsxs)(r.Fragment,{children:[r.jsx("span",{className:"muted",children:s.user.name?`${s.user.name} (${s.user.email??"no-email"})`:s.user.email??"Signed in"}),r.jsx("form",{action:"/api/auth/signout",method:"post",children:r.jsx("button",{type:"submit",children:"Sign out"})})]}):r.jsx("a",{href:"/api/auth/signin/google",children:"Sign in"})]})]}),r.jsx("main",{children:e})]})})})}},33914:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n});var r=t(55886),i=t(42073);let a=(0,t(36691).createProxy)(String.raw`/Users/samuelbourque/codex/mcp-chess/components/game-list-panel.tsx#GameListPanel`);async function n(){let e=await (0,i.I)();return r.jsx("div",{className:"stack",children:r.jsx(a,{currentUserId:e?.user?.id??null})})}},42073:(e,s,t)=>{"use strict";t.d(s,{I:()=>c,L:()=>o});var r=t(96403),i=t(20600),a=t(34512),n=t(7750);let l=[];process.env.GOOGLE_ID&&process.env.GOOGLE_SECRET&&l.push((0,a.Z)({clientId:process.env.GOOGLE_ID,clientSecret:process.env.GOOGLE_SECRET}));let o={adapter:(0,r.N)(n.db),session:{strategy:"database"},providers:l,callbacks:{session:({session:e,user:s})=>(e.user&&(e.user.id=s.id),e)}};function c(){return(0,i.getServerSession)(o)}},7750:(e,s,t)=>{"use strict";t.d(s,{db:()=>n});var r=t(53524);let i=require("node:path");var a=t.n(i);let n=global.prisma||new r.PrismaClient({datasources:{db:{url:function(e){if(!e||!e.startsWith("file:"))return e;let s=e.slice(5);if(s.startsWith("/")||s.startsWith("//"))return e;let t=a().resolve(process.cwd(),s);return`file:${t}`}(process.env.DATABASE_URL)}},log:["error"]})},29944:()=>{}};var s=require("../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[719,976,435],()=>t(83413));module.exports=r})();